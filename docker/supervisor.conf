[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

# 1. Nginx: El Portero (Puerto 80 - P√∫blico)
[program:nginx]
command=nginx -g "daemon off;"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

# 2. PHP-FPM: El Backend (Puerto 9000 - Interno)
[program:php-fpm]
command=php-fpm
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

# 3. Astro: El Frontend (Puerto 3002 - Interno)
[program:astro]
command=node /var/www/astro-server/server/entry.mjs

# Configuraci√≥n de variables (Correcta)
environment=HOST="0.0.0.0",PORT="3002",NODE_ENV="production",DB_HOST="%(ENV_DB_HOST)s",DB_PORT="%(ENV_DB_PORT)s",DB_DATABASE="%(ENV_DB_DATABASE)s",DB_USERNAME="%(ENV_DB_USERNAME)s",DB_PASSWORD="%(ENV_DB_PASSWORD)s",JWT_SECRET="%(ENV_JWT_SECRET)s"

autostart=true
autorestart=true

# üî• CORRECCI√ìN VITAL:
# Antes ten√≠as: /var/log/astro.log (El error se escond√≠a ah√≠ dentro)
# Ahora ponemos: /dev/stdout (El error saldr√° en tu pantalla de Render)
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0